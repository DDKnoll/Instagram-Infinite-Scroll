/*! instagram 2014-05-24 */
var instagramFeed=Ractive.extend({lazy:!0,makeQuery:function(a){var b,c,d,e;switch(b="https://api.instagram.com/v1",this.data.method){case"popular":c="media/popular";break;case"tags":if("string"!=typeof this.data.search)throw new Error("No tag name specified. Use the 'tagName' option.");c="tags/"+this.data.search+"/media/recent";break;case"location":if("number"!=typeof this.data.location)throw new Error("No location specified. Use the 'locationId' option.");c="locations/"+this.data.search+"/media/recent";break;case"user":if("number"!=typeof this.data.userId)throw new Error("No user specified. Use the 'userId' option.");if("string"!=typeof this.data.accessToken)throw new Error("No access token. Use the 'accessToken' option.");c="users/"+this.data.search+"/media/recent";break;default:throw new Error("Invalid option for get: '"+this.data.get+"'.")}switch(d=""+b+"/"+c,null!=this.data.clientID&&(d+="?client_id="+this.data.clientID),null!=this.data.postsPerPage&&(d+="&count="+this.data.postsPerPage),a){case"before":e="&amp;callback=instagramReceiverFrontAppend&amp;min_id="+this.data.instagramData.pagination.min_tag_id;break;case"after":e="&amp;callback=instagramReceiverRearAppend&amp;max_id="+this.data.instagramData.pagination.next_max_tag_id;break;case"replace":e="&amp;callback=instagramReceiverReplace"}return console.log(d+e),d+e},load:function(a){if("after"==a&&this.data.endOfFeed)return!1;if(1==this.data.loading)return!1;this.set("loading",!0),console.log("calling IG API");var b=document.createElement("script");b.id="instagram-script-loader",b.onerror=function(){console.log("unable to reach IG API")},b.src=this.makeQuery(a);var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)},getNewer:function(){this.load("before")},getOlder:function(){this.load("after")},init:function(a){return this.data.instagramData=[],this.data.current=-1,this.data.min=0,this.data.max=0,this.data.lightbox=!1,this.data.endOfFeed=!1,this.data.postsPerPage=6,this.data.method="tags",this.data.message="",void 0==a.clientID?(console.log("No Client ID Provided"),this.success=!1,!1):(this.data.clientID=a.clientID,this.dataCallback=void 0!=a.dataCallback?a.dataCallback:function(){},void 0==a.search?(console.log("No Hashtag Provided"),this.success=!1,!1):(this.data.search=this.data.searched=a.search,this.validateData=function(a){return this.set("loading",!1),400==a.meta.code?(this.error=!0,this.set("message","Invalid Client ID"),this.dataCallback(a),!1):200==a.meta.code?(this.error=!1,!0):(this.error=!0,this.set("message","Error retrieving IG data."),this.dataCallback(a),console.log(a),!1)},this.replaceData=function(a){void 0==a.data?this.set("message","Sorry no results for #"+this.data.search+" :["):(this.set("instagramData",a),this.set("searched",this.data.search),this.set("message",""),this.set("endOfFeed",!1)),this.dataCallback(a)},window.instagramReceiverReplace=function(a){return function(b){a.validateData(b)&&a.replaceData(b)}}(this),this.frontAppend=function(a){0==a.data.length?console.log("Nothing to append"):(console.log("front Append"),this.set("instagramData.data",a.data.concat(this.data.instagramData.data)),this.data.instagramData.pagination.min_tag_id=a.pagination.min_tag_id),this.dataCallback(a)},window.instagramReceiverFrontAppend=function(a){return function(b){a.validateData(b)&&a.frontAppend(b)}}(this),this.rearAppend=function(a){console.log("rear Append"),this.set("instagramData.data",this.data.instagramData.data.concat(a.data)),void 0===a.pagination.next_max_tag_id?this.set("endOfFeed",!0):this.data.instagramData.pagination.next_max_tag_id=a.pagination.next_max_tag_id,this.dataCallback(a)},window.instagramReceiverRearAppend=function(a){return function(b){a.validateData(b)&&a.rearAppend(b)}}(this),this.observe("search",function(){this.load("replace")}),void this.load("replace")))}});